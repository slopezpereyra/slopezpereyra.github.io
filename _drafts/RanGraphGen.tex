\documentclass[a4paper, 12pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{newtxtext} \usepackage{newtxmath}
\usepackage{amsmath, amssymb}
\newtheorem{problem}{Problem}
\newtheorem{example}{Example}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem{problem}{Problem}
\newtheorem{example}{Example} \newtheorem{definition}{Definition}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\usepackage{parskip}

\begin{document}

Some observations:

\begin{itemize}
    \item $K_n$ can span every $G \in \mathcal{G}_n$.
    \item For any $G \in \mathcal{G}_{n, m}$, there are $M = \binom{n}{2} - m$ edges that must be 
        removed to span it from a $K_n$.
    \item The order in which the edges are removed does not matter.
    \item The space of prunable edges $\mathcal{E}$ is not constant, since an edge may become 
        a bridge and disappear from $\mathcal{E}$.
    \item Following the previous statement: $\mathcal{E}$ initializes as $\Lambda(n)$ but 
        loses an element per generated bridge.
\end{itemize}

We know $|\Lambda(n)| = \binom{n}{2}$. There are 

\begin{align*}
    \binom{\frac{n(n-1)}{2}}{\frac{n(n-1)}{2} - m} = \binom{\frac{n(n-1)}{2}}{m} =: C_{n, m}
\end{align*}

graphs in $\mathcal{G}_{n, m}$, but some of them are disconnected. The question
is: how many of them are disconnected. 

Let $\mathcal{A}$ be the class of all graphs. We wish to produce a generating
function for $\mathcal{A}$; this is, a series s.t. its $k$th coefficient is the
number of graphs with $n$ vertices, $m$ edges. We know this quantity
due to the derivation above, and all that is left is to expand it into a series
for each $n, m$.

The mixed exponential generating function for $\mathcal{A}$ is then

\begin{align*}
    A(x) &= \sum_{n=0}^{\infty}\left(\sum_{m = 0}^{\infty} \binom{\frac{n(n-1)}{2}}{m}  y^m\right) \frac{x^n}{n!}\\\\
                                                               &=\sum_{n=0}^{\infty}(1 + y)^{\frac{n(n-1)}{2}} \frac{x^n}{n!} \\\\
                                                               &= 1 + \sum_{n=1}^{\infty} (1+y)^{n(n-1)/2} \frac{x^n}{n!}
\end{align*}

Now, every graph in $\mathcal{A}$ is a set of connected graphs. In other words,
if we define $\mathcal{C}$ the class of connected graphs, the relationship
between these two clases is the set-of relation. This means 

\begin{equation*}
    A(x) = \exp C(x)
\end{equation*}

But we know $A(x)$, so we can find $C(x)$ by taking $\ln A(x)$:

\begin{align*}
    C(x) &= \ln \left[1 + \sum_{n=1}^{\infty} (1+y)^{n(n-1)/2} \frac{x^n}{n!}\right]
\end{align*}

Here, we recall that 

\begin{align*}
    \log (1 + u) &= \sum_{k=1}^{\infty} (-1)^{k+1} \frac{u^k}{k}
\end{align*}

which entails 

\begin{align*}
    C(x) &= \sum_{k=1}^{\infty} \frac{ (-1)^{k+1} }{k} \left[ \sum_{n=1}^{\infty}\left( 1+y \right)^{n (n-1) / 2} \frac{x^n}{n!}  \right]^{k} 
\end{align*}

Thus, $C(x)$ produces an enumeration of all connected graphs of $n$ vertices, and we can arrive at the expression for all connected graphs of $N$ vertices and $M$ edges:

\begin{align*}
    N! y^M x^N \sum_{k=1}^{N} \frac{ (-1)^{k+1} }{k} \left[ \sum_{n=1}^{N}\left( 1+y \right)^{n (n-1) / 2} \frac{x^n}{n!}  \right]^{k} 
\end{align*}

For example, for $M = N - 1$ across $N = 2, 3, \ldots$, this effectively produces the sequence 

\begin{align*}
    1, 1, 3, 16, 125, 1296, \ldots
\end{align*}

which matches the number of trees indicated by the Prufer sequence.




\pagebreak 

We know $\mathcal{G}_{n, m} = \binom{\binom{n}{2}}{m}$. Assuming $n$ is fixed, this 
gives us the generating function

\begin{align*}
    A(z) &= \sum_{k\geq 0}^{\binom{n}{2}} \binom{\binom{n}{2}}{m}\frac{ z^k }{k!} \\ 
         &=\left(1+z\right)^{\binom{n}{2}}\frac{1}{k!}
\end{align*}

for the size of $\mathcal{G}_{n, k}$ across values of $k$. Of course, this generating 
function counts connected and non-connected graphs. But any graph that is 
not connected is a set of connected graphs. Which entails that if $\mathcal{C}_{n, m}$ 
is the set of connected graphs with $n$ vertices, $m$ edges, then it induces 
a generating function

\begin{align*}
    B(z) &= \ln A(z) \\ 
         &= \ln \left[ (1+z)^\binom{n}{2} \right]  \\ 
         &= \binom{n}{2} \ln(1 + z) \\ 
         &= \binom{n}{2} \sum_{k=1}^{\infty} \frac{ (-1)^{k+1} }{k}x^k \\ 
         &= \frac{n(n-1)}{2} \sum_{k=1}^{\infty} \frac{ (-1)^{k+1} }{k}x^k \\ 
\end{align*}

For $n = 3$ this gives: 

\begin{align*}
    3 \sum_{k=1}^{\infty} \frac{ (-1)^{k+1} }{k}x^k &= 3 \left[ 1 - \frac{x^2}{2} + \frac{x^3}{3} + \ldots \right] 
\end{align*}

\pagebreak 

Any $G \in \mathcal{C}_{n, m}$ corresponds univocally to a set of edges
s.t. removing those edges from a $K_n$ produces $G$. This readily entails that,
if we let $\mathcal{E}_{n, m} \subseteq \Lambda(n)$ be the class of edges which,
if removed from a $K_n$, produce a graph in $\mathcal{C}_{n, m}$,

$$
|\mathcal{E}_{n, m}| = \mathbb{G}(n, m)
$$

Furthermore, for any $W \in \mathcal{E}_{n, m}$ it is the case that $|W| =
\binom{n}{2} - m$. 

Let $f_{n,m} : \mathcal{E}_{n,m} \mapsto \mathcal{C}_{n, m}$ denote the
bijection $f(W) = \Big(V(K_n), E(K_n) - W\Big)$. We shall prove that
\textit{(1)} our algorithm effectively constructs a $W \in \mathcal{E}_{n,m}$
and computes $f(W)$ and \textit{(2)} that any $W \in \mathcal{E}_{n,m}$ has an
equal probability of being constructed.

\textit{(1)} The algorithm iteratively removes edges ensuring that the
connectivity invariant is preserved. It is trivial to see that it removes $k :=
\binom{n}{2} - m$ edges. Let $S = \{e_1, \ldots, e_{k}\}$ be the set of
randomly sampled edges, where $e_i$ was sampled at the $i$th edge-removing
iteration.

It follows that, in the edge-removing iterations, the sampling spaces $E_1,
\ldots, E_r$ are

\begin{align*}
    E_1 &= \left\{ e \in W : W \in \mathcal{E}_{n,m}  \right\}  \\ 
    E_2 &= \left\{ e \in W : W \in \mathcal{E}_{n,m} \land \left\{ e_1 \right\}  \subseteq  W  \right\} \\ 
    E_3 &= \left\{ e \in W : W \in \mathcal{E}_{n,m} \land \left\{ e_1, e_2 \right\}  \subseteq  W  \right\} \\ 
    \vdots 
\end{align*}

Thus, the general form is $E_i = \left\{ e \in W : W \in \mathcal{E}_{n,m} \land \left\{ e_1, \ldots, e_{i-1} \right\} \subseteq W \right\} $.

It follows that $S = \left\{ e_1, \ldots, e_k \right\} \subseteq W$ for some $W
\in \mathcal{E}_{n,m}$. But $|S| = |W| = k$. Then $S = W$ and $S \in
\mathcal{E}_{n,m}$. And since $S$ is the set of removed edges, the algorithm
generates $f(S)$.

\textit{(2)} Since there is a bijection between $\mathcal{C}_{n,m}$ and
$\mathcal{E}_{n,m}$, a graph is more probable than others if and only if there
is an $S \in \mathcal{E}_{n,m}$ that is more probably constructed than others.
This could only be true for two cases: \textit{(1)} An edge or set of edges in
$S$ is more likely to be chosen, or \textit{(2)} $S$ contains more elements
than other members of $\mathcal{E}_{n,m}$. But \textit{(1)} is impossible if
the selection is random, and \textit{(2)} contradicts that $|S| = \binom{n}{2}
- m$ for every $S \in \mathcal{E}_{n,m}$.

$\therefore $ The algorithm is correct and is unbiased.



\pagebreak
\begin{enumerate}
    \item Define $E = \mathcal{E}_{n, m}$.
    \item Define $S = \emptyset$.
    \item Define $G = K_n$.
    \item Sample randomly an edge $e$ s.t. $e \in W$ for some $W \in E$. 
    \item Compute $G = f'_{n,m}(e, G)$. 
    \item Update $S = S \cup e $ and $E = \left\{ W \in E : S \subseteq W \right\} $
    \item If number of edges is not $m$ go to \textit{(4)}.
\end{enumerate}

When the algorithm finishes, $S$ contains a certain number of selected edges;
and not only this, $S \in \mathcal{E}_{n,m}$ (prove this). Thus, the
computation equates to $f_{n,m}(S)$.

To prove that $S \in \mathcal{E}_{n,m}$, we must only see that the \textit{(1)}
$|S| = \binom{n}{2} - m$ and \textit{(2)} that removing $S$ from $K_n$ does not
disconnect the graph. This two statements are obvious by construction of $S$.


\pagebreak

Of course, this is equivalent to defining $E$ and $S$ as before and doing the following process $\binom{n}{2} - m$ times:

\begin{enumerate}
    \item Sample randomly an edge $e$ s.t. $e \in W$ for some $W \in E$. 
    \item Update $S = S \cup e $ and $E = \left\{ W \in E : S \subseteq W \right\} $
\end{enumerate}

and then computing $f_{n,m}(S)$. The only difference lies in that in one
algorithm the edges are removed on iterations, and on the other the edges are
removed at the end. 

That $S \in \mathcal{E}_{n, m}$ is obvious by construction, 
since all elements in $S$ are sampled from either $\mathcal{E}_{n,m}$
or 

So we have a possible recursive procedure:

Thus, the step of our original algorithm which checks if removing the edge
disconnects the graph simply checks whether the chosen edge $e$ is such that
there is some $W \in E$ s.t. $e \in W$.

The bijection $f_{n, m}$ allows us to ask the question differently. Instead of
asking if certain graphs are more likely to be generated, we ask whether
certain edge sets $S$ are more likely to be constructed. 

This corresponds to asking whether, in the domain of $f_{n,m}$, an edge is in
more sets than other edges. If this were the case, then removing this edge from
the $K_n$ would result in more possible graphs than removing another edge. But
this makes no sense, because after removing any edge from a $K_n$ I can produce
the same number of graphs than before; i.e. a unique removal does not shrink
$E$ (this should be proven).


\end{document}



